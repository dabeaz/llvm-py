
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Module (llvm.core)</title>
    
    <meta name="author" content="">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/stylesheets/pygment_trac.css" rel="stylesheet" type="text/css">
    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>

    <div class="navbar">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="/">llvm-py Documentation</a>
          <ul class="nav">
            
            
            


  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container">

      <div class="content">
        
<div class="page-header">
  <h1>Module (llvm.core) </h1>
</div>

<div class="row">
  <div class="span12">
    <p>Modules are top-level container objects. You need to create a module object first, before you can add global variables, aliases or functions. Modules are created using the static method <code>Module.new</code>:</p>
<div class='highlight'><pre><code class='python'><span class='c'>#!/usr/bin/env python</span>

<span class='kn'>from</span> <span class='nn'>llvm</span> <span class='kn'>import</span> <span class='o'>*</span>
<span class='kn'>from</span> <span class='nn'>llvm.core</span> <span class='kn'>import</span> <span class='o'>*</span>

<span class='c'># create a module</span>
<span class='n'>my_module</span> <span class='o'>=</span> <span class='n'>Module</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='s'>&#39;my_module&#39;</span><span class='p'>)</span>
</code></pre>
</div>
<p>The constructor of the Module class should <em>not</em> be used to instantiate a Module object. This is a common feature for all llvm-py classes.</p>

<blockquote>
<p><strong>Convention</strong></p>

<p><em>All</em> llvm-py objects are instantiated using static methods of corresponding classes. Constructors <em>should not</em> be used.</p>

<p>The argument <code>my_module</code> is a module identifier (a plain string). A module can also be constructed via deserialization from a bit code file, using the static method <code>from_bitcode</code>. This method takes a file-like object as argument, i.e., it should have a <code>read()</code> method that returns the entire data in a single call, as is the case with the builtin file object. Here is an example:</p>
</blockquote>
<div class='highlight'><pre><code class='python'><span class='c'># create a module from a bit code file</span>
<span class='n'>bcfile</span> <span class='o'>=</span> <span class='nb'>file</span><span class='p'>(</span><span class='s'>&quot;test.bc&quot;</span><span class='p'>)</span>
<span class='n'>my_module</span> <span class='o'>=</span> <span class='n'>Module</span><span class='o'>.</span><span class='n'>from_bitcode</span><span class='p'>(</span><span class='n'>bcfile</span><span class='p'>)</span>
</code></pre>
</div>
<p>There is corresponding serialization method also, called <code>to_bitcode</code>:</p>
<div class='highlight'><pre><code class='python'><span class='c'># write out a bit code file from the module</span>
<span class='n'>bcfile</span> <span class='o'>=</span> <span class='nb'>file</span><span class='p'>(</span><span class='s'>&quot;test.bc&quot;</span><span class='p'>,</span> <span class='s'>&quot;w&quot;</span><span class='p'>)</span>
<span class='n'>my_module</span><span class='o'>.</span><span class='n'>to_bitcode</span><span class='p'>(</span><span class='n'>bcfile</span><span class='p'>)</span>
</code></pre>
</div>
<p>Modules can also be constructed from LLVM assembly files (<code>.ll</code> files). The static method <code>from_assembly</code> can be used for this. Similar to the <code>from_bitcode</code> method, this one also takes a file-like object as argument:</p>
<div class='highlight'><pre><code class='python'><span class='c'># create a module from an assembly file</span>
<span class='n'>llfile</span> <span class='o'>=</span> <span class='nb'>file</span><span class='p'>(</span><span class='s'>&quot;test.ll&quot;</span><span class='p'>)</span>
<span class='n'>my_module</span> <span class='o'>=</span> <span class='n'>Module</span><span class='o'>.</span><span class='n'>from_assembly</span><span class='p'>(</span><span class='n'>llfile</span><span class='p'>)</span>
</code></pre>
</div>
<p>Modules can be converted into their assembly representation by stringifying them (see below).</p>
<hr />
<h1 id='llvmcoremodule'>llvm.core.Module</h1>
<div class='maruku_toc'><ul style='list-style: none;'><li><a href='#static_constructors'>Static Constructors</a><ul style='list-style: none;'><li><a href='#id239'><code>new(module_id)</code></a></li><li><a href='#id240'><code>from_bitcode(fileobj)</code></a></li><li><a href='#id241'><code>from_assembly(fileobj)</code></a></li></ul></li><li><a href='#properties'>Properties</a><ul style='list-style: none;'><li><a href='#id242'><code>data_layout</code></a></li><li><a href='#id243'><code>target</code></a></li><li><a href='#id244'><code>pointer_size</code></a></li><li><a href='#id245'><code>global_variables</code></a></li><li><a href='#id246'><code>functions</code></a></li></ul></li><li><a href='#methods'>Methods</a><ul style='list-style: none;'><li><a href='#id247'><code>get_type_named(name)</code></a></li><li><a href='#id248'><code>add_type_name(name, ty)</code></a></li><li><a href='#id249'><code>delete_type_name(name)</code></a></li><li><a href='#id250'><code>add_global_variable(ty, name)</code></a></li><li><a href='#id251'><code>get_global_variable_named(name)</code></a></li><li><a href='#id252'><code>add_function(ty, name)</code></a></li><li><a href='#id253'><code>get_function_named(name)</code></a></li><li><a href='#id254'><code>get_or_insert_function(ty, name)</code></a></li><li><a href='#id255'><code>verify()</code></a></li><li><a href='#id256'><code>to_bitcode(fileobj)</code></a></li><li><a href='#id257'><code>link_in(other)</code></a></li></ul></li><li><a href='#special_methods'>Special Methods</a><ul style='list-style: none;'><li><a href='#id258'><code>__str__</code></a></li><li><a href='#id259'><code>__eq__</code></a></li></ul></li></ul></div>
<h2 id='static_constructors'>Static Constructors</h2>

<h3 id='id239'><code>new(module_id)</code></h3>

<p>Create a new <code>Module</code> instance with given <code>module_id</code>. The <code>module_id</code> should be a string.</p>

<h3 id='id240'><code>from_bitcode(fileobj)</code></h3>

<p>Create a new <code>Module</code> instance by deserializing the bitcode file represented by the file-like object <code>fileobj</code>.</p>

<h3 id='id241'><code>from_assembly(fileobj)</code></h3>

<p>Create a new <code>Module</code> instance by parsing the LLVM assembly file represented by the file-like object <code>fileobj</code>.</p>

<h2 id='properties'>Properties</h2>

<h3 id='id242'><code>data_layout</code></h3>

<p>A string representing the ABI of the platform.</p>

<h3 id='id243'><code>target</code></h3>

<p>A string like <code>i386-pc-linux-gnu</code> or <code>i386-pc-solaris2.8</code>.</p>

<h3 id='id244'><code>pointer_size</code></h3>

<p>[read-only]</p>

<p>The size in bits of pointers, of the target platform. A value of zero represents <code>llvm::Module::AnyPointerSize</code>.</p>

<h3 id='id245'><code>global_variables</code></h3>

<p>[read-only]</p>

<p>An iterable that yields <a href='llvm.core.GlobalVariable.html'>GlobalVariable</a> objects, that represent the global variables of the module.</p>

<h3 id='id246'><code>functions</code></h3>

<p>[read-only]</p>

<p>An iterable that yields <a href='llvm.core.Function.html'>Function</a> objects, that represent functions in the module.</p>

<h2 id='methods'>Methods</h2>

<h3 id='id247'><code>get_type_named(name)</code></h3>

<p>Return a <a href='llvm.core.Type.html'>Type</a> object for the given alias name (typedef).</p>

<h3 id='id248'><code>add_type_name(name, ty)</code></h3>

<p>Add an alias (typedef) for the type <code>ty</code> with the name <code>name</code>.</p>

<h3 id='id249'><code>delete_type_name(name)</code></h3>

<p>Delete an alias with the name <code>name</code>.</p>

<h3 id='id250'><code>add_global_variable(ty, name)</code></h3>

<p>Add a global variable of the type <code>ty</code> with the name <code>name</code>. Returns a <a href='llvm.core.GlobalVariable.html'>GlobalVariable</a> object.</p>

<h3 id='id251'><code>get_global_variable_named(name)</code></h3>

<p>Get a <a href='llvm.core.GlobalVariable.html'>GlobalVariable</a> object corresponding to the global variable with the name <code>name</code>. Raises <code>LLVMException</code> if such a variable does not exist.</p>

<h3 id='id252'><code>add_function(ty, name)</code></h3>

<p>Add a function named <code>name</code> with the function type <code>ty</code>. <code>ty</code> must of an object of type <a href='llvm.core.FunctionType.html'>FunctionType</a>.</p>

<h3 id='id253'><code>get_function_named(name)</code></h3>

<p>Get a <a href='llvm.core.Function.html'>Function</a> object corresponding to the function with the name <code>name</code>. Raises <code>LLVMException</code> if such a function does not exist.</p>

<h3 id='id254'><code>get_or_insert_function(ty, name)</code></h3>

<p>Like <code>get_function_named</code>, but adds the function first, if not present (like <code>add_function</code>).</p>

<h3 id='id255'><code>verify()</code></h3>

<p>Verify the correctness of the module. Raises <code>LLVMException</code> on errors.</p>

<h3 id='id256'><code>to_bitcode(fileobj)</code></h3>

<p>Write the bitcode representation of the module to the file-like object <code>fileobj</code>.</p>

<h3 id='id257'><code>link_in(other)</code></h3>

<p>Link in another module <code>other</code> into this module. Global variables, functions etc. are matched and resolved. The <code>other</code> module is no longer valid and should not be used after this operation. This API might be replaced with a full-fledged Linker class in the future.</p>

<h2 id='special_methods'>Special Methods</h2>

<h3 id='id258'><code>__str__</code></h3>

<p><code>Module</code> objects can be stringified into it&#8217;s LLVM assembly language representation.</p>

<h3 id='id259'><code>__eq__</code></h3>

<p><code>Module</code> objects can be compared for equality. Internally, this converts both arguments into their LLVM assembly representations and compares the resultant strings.</p>

<blockquote>
<p><strong>Convention</strong></p>

<p><em>All</em> llvm-py objects (where it makes sense), when stringified, return the LLVM assembly representation. <code>print module_obj</code> for example, prints the LLVM assembly form of the entire module.</p>

<p>Such objects, when compared for equality, internally compare these string representations.</p>
</blockquote>
  </div>
</div>


      </div>

      <footer>
        <p>&copy;  2012
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div> <!-- /container -->

    
  </body>
</html>

